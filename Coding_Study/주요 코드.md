### 드라이브에서 데이터 가져오기
``` python
import pandas as pd
from google.colab import drive
drive.mount('/content/drive')
folder_path = f"/content/drive/MyDrive/"
df = pd.read_csv(f"{folder_path}datasets/df.csv")
```


## 모델 저장

```python

input_dim = 128 * 128
neuralnet = DeepNN(input_dim=input_dim)

criterion = nn.BCELoss()
optimizer = optim.Adam(neuralnet.parameters(), lr=0.001)

# 학습
num_epochs = 20
d_train_losses, d_train_accuracies, d_val_losses, d_val_accuracies, d_test_losses, d_test_accuracies = train(neuralnet, train_loader, val_loader, test_loader, optimizer, criterion, num_epochs=num_epochs)

### ------- 모델 저장 ---------
if save_model:
    # 모델 출력 저장
    torch.save(neuralnet.state_dict(), os.path.join(root_dir, "DeepNN.pth"))


### ------- 모델 결과 저장 ---------

if save_result:
    # 결과 저장
    logs = {
        'train_loss': d_train_losses,
        'val_loss': d_val_losses,
        'test_loss': d_test_losses,
        'train_acc': d_train_accuracies,
        'val_acc': d_val_accuracies,
        'test_acc': d_test_accuracies
    }

    # 저장
    with open(os.path.join(root_dir, 'DeepNN_logs.pkl'), 'wb') as f:
        pickle.dump(logs, f)
        
```



### GPU 연결

- `런타임(Runtime)` → `런타임 유형 변경(Change runtime type)` 클릭
- 하드웨어 가속기(Hardware accelerator) 옵션에서 **GPU** 선택

```python

## PyTorch 쓸 때
import torch

if torch.cuda.is_available():
    print("GPU is 연결됨:", torch.cuda.get_device_name(0))
else:
    print("GPU를 사용할 수 없습니다.")


## Tensorflow 쓸 때
import tensorflow as tf

if tf.config.list_physical_devices('GPU'):
    print("GPU 연결됨:", tf.config.list_physical_devices('GPU'))
else:
    print("GPU를 사용할 수 없습니다.")


```

- 데이터 프레임 csv로 저장

`df.to_csv('example.csv', index=False, encoding='utf-8')`
- 사진 저장

`plt.savefig('plot.png')`
→ plt.show() 전에 쓰기

- 그래프 그리기
```python
plt.figure(figsize=(10, 8))

sns.lineplot(y=kospi['Close'], x=kospi.index, color = "#0000CD", linewidth = 2)
plt.xlabel('time')
plt.ylabel('price')
plt.title("KOSPI Time Series")
plt.savefig(f"{col}.png")
```


### 그래프 한국어 깨짐
```python

# step1. install
!sudo apt-get install -y fonts-nanum
!sudo fc-cache -fv
!rm ~/.cache/matplotlib -rf

# step2. retry runtime

# step3
import matplotlib.pyplot as plt
plt.rc('font', family='NanumBarunGothic')
``` 
